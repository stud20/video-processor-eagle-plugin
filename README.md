# Video Processor for Eagle

🎬 Eagle 플러그인을 위한 동영상 프로세서 - 컷 변화 감지 및 프레임/클립 추출

## 📋 개요

Video Processor for Eagle은 Eagle 에셋 관리 프로그램에서 동영상 파일을 처리하여 컷 변화를 감지하고, 각 컷의 중간 프레임과 개별 클립을 추출하는 플러그인입니다.

## ✨ 주요 기능

### 🔍 컷 변화 감지
- FFmpeg 기반 장면 변화 감지
- 사용자 정의 민감도 설정 (0.1 ~ 0.7)
- 자동 컷 포인트 정제 및 최적화

### 🖼️ 프레임 추출
- 각 컷의 중간 지점에서 프레임 추출
- JPG/PNG 포맷 지원
- 품질 설정 가능 (1-10)

### 🎬 클립 추출
- 컷 변화 기준 개별 클립 분할
- MP4 포맷으로 고품질 재인코딩
- 프레임 단위 정확한 인점/아웃점 분할

### 📚 배치 처리 **(NEW)**
- 여러 동영상 동시 선택 및 처리
- 파일별 진행 상황 실시간 표시
- 처리 취소 기능
- 상세한 배치 결과 리포트

### ⚡ 성능 최적화
- 병렬 처리로 빠른 추출 속도
- 고속 병렬 방식 (최대 12개 동시 처리)
- 안정 병렬 방식 (4개 동시 처리)
- 스트리밍 임포트로 메모리 효율화

### 📥 Eagle 자동 임포트
- 추출된 파일 자동 분류
- 태그 및 메타데이터 자동 생성
- 전용 폴더 자동 생성
- 중복 파일 덮어쓰기/건너뛰기 옵션

## 🛠️ 설치 및 설정

### 필수 요구사항

1. **Eagle 4.0 이상**
2. **Eagle FFmpeg Extra Module** (플러그인이 자동 설치)
3. **macOS/Windows** (Eagle 지원 OS)

### 플러그인 설치

1. 이 저장소를 클론하거나 다운로드
```bash
git clone https://github.com/greatminds/video-processor-eagle-plugin.git
cd video-processor-eagle-plugin
```

2. Eagle에서 플러그인 로드
   - Eagle 실행 → 플러그인 → 로컬 플러그인 추가
   - 프로젝트 폴더 선택

## 🚀 사용법

### 1. 기본 사용법

1. **동영상 선택**
   - Eagle에서 동영상 파일 선택
   - 플러그인 실행

2. **설정 조정**
   - 컷 변화 민감도: 0.1 (매우 민감) ~ 0.7 (둔감)
   - 이미지 포맷: JPG 또는 PNG
   - 출력 품질: 1 (낮음) ~ 10 (높음)
   - 추출 방식: 고속 병렬 또는 안정 병렬
   - 중복 파일 처리: 덮어쓰기 또는 건너뛰기

3. **처리 실행**
   - 🖼️ 이미지 추출: 프레임만 추출
   - 🎬 클립 추출: 클립만 추출
   - 📋 모든 처리: 프레임과 클립 모두 추출

### 2. 배치 처리 사용법

1. **여러 파일 선택**
   - Eagle에서 Ctrl/Cmd + 클릭으로 여러 동영상 선택
   - 플러그인 실행 시 자동으로 배치 모드 활성화

2. **진행 상황 확인**
   - 전체 진행률: 현재 파일 / 전체 파일
   - 개별 파일 진행 상황 실시간 표시

3. **처리 취소**
   - 진행 중 "❌ 취소" 버튼 클릭
   - 현재 파일 완료 후 중단

4. **결과 확인**
   - 성공/실패 파일 수 통계
   - 각 파일별 처리 결과 상세 정보
   - 총 컷포인트, 프레임, 클립 수
   - 각 파일별 처리 시간

### 3. 고급 사용법

#### 민감도 설정 가이드
- **0.1-0.2**: 매우 민감 (작은 변화도 감지)
- **0.3-0.4**: 보통 (권장)
- **0.5-0.6**: 둔감 (큰 변화만 감지)
- **0.7**: 매우 둔감 (드라마틱한 변화만)

#### 품질 설정 가이드
- **1-3**: 낮은 품질, 작은 파일 크기
- **4-6**: 보통 품질 (웹용)
- **7-8**: 높은 품질 (권장)
- **9-10**: 최고 품질, 큰 파일 크기

#### 추출 방식 선택
- **고속 병렬 방식**: 최대 12개 동시 처리로 최고 속도
- **안정 병렬 방식**: 4개 동시 처리로 안정성 보장

## 📁 출력 파일 구조

```
Eagle 라이브러리/
├── AnalyzedClips/                 # 분석된 모든 클립 루트 폴더
│   └── [비디오명]/                # 비디오별 개별 폴더
│       ├── [비디오명]_frame_001.jpg   # 추출된 프레임
│       ├── [비디오명]_frame_002.jpg
│       ├── [비디오명]_clip_001.mp4    # 추출된 클립
│       └── [비디오명]_clip_002.mp4
└── .video-processor-cache/        # 임시 캐시 폴더
    └── session-[timestamp]/       # 세션별 임시 파일
```

## 🎯 사용 예시

### 광고 제작 워크플로우
1. 클라이언트 제공 영상을 Eagle에 임포트
2. Video Processor로 장면별 분할
3. 각 장면의 대표 프레임으로 스토리보드 생성
4. 필요한 클립만 선별하여 편집 소프트웨어에 전달

### 다큐멘터리 제작 워크플로우
1. 인터뷰 영상 분석
2. 주요 발언 구간 자동 분할
3. 각 구간의 프레임으로 빠른 내용 파악
4. 편집 포인트 사전 설정

## 🔍 기술적 상세

### 프레임 단위 정확도

Video Processor for Eagle은 프레임 단위로 정확한 컷 분할을 지원합니다:

- **인점 (In Point)**: 컷이 바뀐 정확한 그 프레임
- **아웃점 (Out Point)**: 다음 컷이 바뀌기 3프레임 전 (-3 프레임)
- **프레임 정보 활용**: FPS 정보를 기반으로 시간을 프레임 번호로 변환
- **편집 안전 마진**: 3프레임 여유로 더 깨끗한 트랜지션
- **FFmpeg 최적화**: `-vsync vfr` 옵션으로 가변 프레임 레이트 지원

## 🔧 개발 및 커스터마이징

### 프로젝트 구조

```
video-processor-eagle-plugin/
├── manifest.json              # 플러그인 설정
├── package.json              # Node.js 설정
├── src/
│   ├── main.html             # 메인 UI
│   ├── main.js               # 메인 로직
│   ├── styles.css            # 스타일시트
│   └── modules/              # 기능 모듈
│       ├── video-analyzer.js  # 비디오 분석
│       ├── frame-extractor.js # 프레임 추출
│       ├── clip-extractor.js  # 클립 추출
│       └── eagle-importer.js  # Eagle 연동
├── assets/
│   └── icons/               # 아이콘
└── README.md
```

### 테스트 체크리스트

- [ ] 작은 동영상 파일 (< 1분)로 테스트
- [ ] 한글 파일명 테스트
- [ ] 다양한 해상도 테스트
- [ ] 다양한 포맷 테스트 (MP4, MOV, AVI, MKV)
- [ ] 긴 동영상 파일 (> 10분) 테스트
- [ ] 병렬 처리 성능 테스트

## 🐛 문제 해결

### 일반적인 문제

**Q: "Eagle FFmpeg 의존성을 설치하고 있습니다" 메시지가 계속 나타납니다**
A: 플러그인이 FFmpeg를 자동으로 설치합니다. 첫 실행 시 잠시 기다려주세요.

**Q: 플러그인이 로드되지 않습니다**
A: 
1. Eagle 4.0 이상인지 확인
2. manifest.json 파일 문법 확인
3. Eagle 개발자 도구에서 오류 확인

**Q: 처리 속도가 너무 느립니다**
A:
1. 민감도를 높여 감지되는 컷 수 줄이기 (0.3 → 0.5)
2. 품질 설정을 낮춰 처리 속도 향상 (8 → 5)
3. 최소 클립 길이를 늘려 작은 클립 제외

**Q: 컷 변화가 제대로 감지되지 않습니다**
A:
1. 민감도를 낮춰보세요 (0.3 → 0.2)
2. 영상의 특성에 맞춰 설정 조정
3. 다른 추출 방식 시도

### 로그 및 디버깅

개발자 도구 (F12)를 열어 콘솔 로그를 확인하세요:
```javascript
// 브라우저 콘솔에서 디버깅
VideoProcessor.debugEagleAPI();
VideoProcessor.debugModules();
```

## 🔄 업데이트 및 버전 관리

### 현재 버전: 1.2.0

### 변경사항
- **1.2.0**: 프레임 단위 정확도 개선
  - 컷 변화 감지를 프레임 단위로 처리
  - 인점/아웃점 정확도 향상 (프레임 단위)
  - 컷이 바뀐 정확한 프레임이 시작점, 다음 컷 3프레임 전이 끝점
  - 편집 안전 마진으로 더 깨끗한 트랜지션 보장
  - 프레임 정보를 활용한 더 정확한 클립 분할
  
- **1.1.0**: 배치 처리 기능 추가
  - 여러 파일 동시 처리 지원
  - 배치 진행률 및 취소 기능
  - 상세한 파일별 처리 결과 리포트
  - 배치 작업 통계 표시
  
- **1.0.2**: 사용성 개선
  - 최소 클립 길이 옵션 제거 (모든 짧은 클립도 추출)
  - 더 짧은 프레임 및 컬 처리 가능
  
- **1.0.1**: 정확도 개선
  - AnalyzedClips 폴더 구조 개선 (비디오별 하위 폴더)
  - 클립 인/아웃 포인트 정확도 향상
  - 프레임 누락 문제 해결
  
- **1.0.0**: 초기 릴리즈
  - 기본 컷 변화 감지
  - 프레임 및 클립 추출
  - Eagle 자동 임포트
  - 병렬 처리 최적화
  - 스트리밍 임포트

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📝 라이센스

이 프로젝트는 MIT 라이센스 하에 배포됩니다. 자세한 내용은 `LICENSE` 파일을 참조하세요.

## 👨‍💻 개발자

**슷터드 (greatminds)**
- 광고·브랜디드 콘텐츠·다큐멘터리 중심의 영상 프로덕션 대표/감독
- 서강대학교 미디어커뮤니케이션대학원 AI·버추얼 콘텐츠 전공

## 📞 지원 및 문의

- GitHub Issues: [이슈 등록](https://github.com/greatminds/video-processor-eagle-plugin/issues)
- Email: [프로젝트 문의](mailto:contact@greatminds.co.kr)

## 🙏 감사의 말

- [Eagle Team](https://eagle.cool): 강력한 에셋 관리 도구와 플러그인 API 제공
- [FFmpeg Team](https://ffmpeg.org): 최고의 멀티미디어 처리 라이브러리
- 모든 베타 테스터와 피드백을 제공해주신 분들

---

**Made with ❤️ by greatminds**
